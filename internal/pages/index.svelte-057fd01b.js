var y=Object.defineProperty,T=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var N=(e,t,a)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,L=(e,t)=>{for(var a in t||(t={}))j.call(t,a)&&N(e,a,t[a]);if(H)for(var a of H(t))J.call(t,a)&&N(e,a,t[a]);return e},P=(e,t)=>T(e,V(t));import{S as K,i as X,s as x,e as S,k as W,c as C,a as $,m as U,d as M,b as i,K as A,f as Q,g as z,J as I,L as Z,n as B,M as ee}from"../chunks/index-dd47dd75.js";function D(e){let t=e.length,a;for(;t!=0;)a=Math.floor(Math.random()*t),t--,[e[t],e[a]]=[e[a],e[t]];return e}const f="/mario-games/",te=`${f}cards/mushroom.png`,ae=`${f}cards/flower.png`,ne=`${f}cards/coin10.png`,se=`${f}cards/coin20.png`,re=`${f}cards/star.png`,oe=`${f}cards/chest.png`,ce=`${f}cards/backface.png`,le=`${f}cards/highlight.png`,ie=`${f}sounds/correct-match.wav`,de=`${f}sounds/wrong-match.wav`,ue=`${f}sounds/loose.wav`,ge=`${f}sounds/win.wav`;var G=(e=>(e.MUSHROOM="ncard/MUSHROOM",e.FLOWER="ncard/FLOWER",e.COIN10="ncard/COIN10",e.COIN20="ncard/COIN20",e.STAR="ncard/STAR",e.CHEST="ncard/CHEST",e))(G||{});const b=e=>{const t=`${e}`.replace("ncard/","");switch(e){case"ncard/MUSHROOM":return{img:te,type:e,name:t};case"ncard/FLOWER":return{img:ae,type:e,name:t};case"ncard/CHEST":return{img:oe,type:e,name:t};case"ncard/COIN10":return{img:ne,type:e,name:t};case"ncard/COIN20":return{img:se,type:e,name:t};case"ncard/STAR":return{img:re,type:e,name:t};default:throw"Unknown card type"}},he=()=>ce,me=()=>le,R={correctMatch:()=>new Audio(ie),wrongMatch:()=>new Audio(de),loose:()=>new Audio(ue),win:()=>new Audio(ge)},fe=()=>{const e=D([...Object.values(G)]),t=Math.ceil(e.length/2);return{big:e.slice(0,t),small:e.slice(-t)}},ve=()=>{const e=fe(),t=[].concat(...e.big.map(n=>[b(n),b(n),b(n),b(n)])),a=[].concat(...e.small.map(n=>[b(n),b(n)]));return D([...t,...a])};function F(e,t,a){const n=e.slice();return n[14]=t[a],n[16]=a,n}function q(e){let t,a,n,o,r,c,s,l,d,v,k,_,O,w;return{c(){t=S("div"),a=S("button"),n=S("img"),r=W(),c=S("img"),_=W(),this.h()},l(h){t=C(h,"DIV",{class:!0,style:!0});var m=$(t);a=C(m,"BUTTON",{class:!0,title:!0,"aria-label":!0,"data-target-idx":!0});var u=$(a);n=C(u,"IMG",{class:!0,src:!0,alt:!0}),r=U(u),c=C(u,"IMG",{class:!0,src:!0,alt:!0}),u.forEach(M),_=U(m),m.forEach(M),this.h()},h(){i(n,"class","face front svelte-hgnohp"),A(n.src,o=e[14].img)||i(n,"src",o),i(n,"alt","Front face"),i(c,"class","face back svelte-hgnohp"),A(c.src,s=e[1])||i(c,"src",s),i(c,"alt","Back face"),i(a,"class",l="card "+(e[14].revealed?"revealed":"")+" svelte-hgnohp"),a.disabled=d=e[14].revealed,i(a,"title",v=e[14].name),i(a,"aria-label","Card"),i(a,"data-target-idx",k=e[16]),i(t,"class","card-wrapper svelte-hgnohp"),Q(t,"--highlight-img","url("+e[2]+")")},m(h,m){z(h,t,m),I(t,a),I(a,n),I(a,r),I(a,c),I(t,_),O||(w=Z(a,"click",e[3]),O=!0)},p(h,m){m&1&&!A(n.src,o=h[14].img)&&i(n,"src",o),m&1&&l!==(l="card "+(h[14].revealed?"revealed":"")+" svelte-hgnohp")&&i(a,"class",l),m&1&&d!==(d=h[14].revealed)&&(a.disabled=d),m&1&&v!==(v=h[14].name)&&i(a,"title",v)},d(h){h&&M(t),O=!1,w()}}}function _e(e){let t,a,n=e[0],o=[];for(let r=0;r<n.length;r+=1)o[r]=q(F(e,n,r));return{c(){t=S("div"),a=S("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){t=C(r,"DIV",{class:!0});var c=$(t);a=C(c,"DIV",{class:!0});var s=$(a);for(let l=0;l<o.length;l+=1)o[l].l(s);s.forEach(M),c.forEach(M),this.h()},h(){i(a,"class","cards-board svelte-hgnohp"),i(t,"class","memory-game svelte-hgnohp")},m(r,c){z(r,t,c),I(t,a);for(let s=0;s<o.length;s+=1)o[s].m(a,null)},p(r,[c]){if(c&15){n=r[0];let s;for(s=0;s<n.length;s+=1){const l=F(r,n,s);o[s]?o[s].p(l,c):(o[s]=q(l),o[s].c(),o[s].m(a,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},i:B,o:B,d(r){r&&M(t),ee(o,r)}}}const we=3;function pe(e,t,a){const n=he(),o=me(),r=ve();let c=0,s=!1,l=new Set,d=new Set,v=w();async function k(){s=!0,await document.querySelector(".memory-game").animate([{backgroundPosition:"0 center"},{backgroundPosition:" 100px center"}],{duration:150,easing:"steps(2)",direction:"normal",iterations:10,fill:"forwards"}).finished,s=!1}async function _(u,g="normal"){s=!0,await u.animate([{transform:"rotateY(0.5turn)"},{transform:"rotateY(2turn)"}],{duration:1e3,easing:"ease",direction:g}).finished,s=!1}function O(){return new Set([...d].map(g=>r[g].type)).size===1}function w(){return r.map((u,g)=>P(L({},u),{revealed:l.has(g)||d.has(g)}))}async function h(u,g){if(!(d.size===2||s||l.has(g)||d.has(g))){if(console.log("Revealing..."),await _(u),d=new Set([...d,g]),a(0,v=w()),console.log("Revealed..."),d.size!==2){console.log("Ready for more");return}if(O()){l=new Set([...l,...d]);const p=l.size===v.length,E=p?R.win():R.correctMatch();await Promise.all([E.play(),await k()]),console.log("RIGHT!!! congrats!"),p&&(alert("You win!!!!!!, Restarting game..."),window.location.reload())}else{c+=1,console.log("WRONG!!!! resetting play");const p=c>=we,E=p?R.loose():R.wrongMatch();await Promise.all([E.play(),...[...d].map(Y=>_(document.querySelector(`.card[data-target-idx="${Y}"]`),"reverse"))]),p&&(alert("You loose, Restarting game..."),window.location.reload())}d=new Set,a(0,v=w())}}function m(u){const g=u.currentTarget;h(g,Number(g.dataset.targetIdx))}return[v,n,o,m]}class Se extends K{constructor(t){super(),X(this,t,pe,_e,x,{})}}export{Se as default};
