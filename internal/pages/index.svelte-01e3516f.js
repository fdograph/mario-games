var D=Object.defineProperty,G=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var E=(e,t,a)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,H=(e,t)=>{for(var a in t||(t={}))z.call(t,a)&&E(e,a,t[a]);if($)for(var a of $(t))V.call(t,a)&&E(e,a,t[a]);return e},N=(e,t)=>G(e,y(t));import{S as T,i as Y,s as J,e as b,k as j,c as w,a as O,m as P,d as I,b as u,K as R,f as K,g as F,J as p,L as x,n as A,M as Q}from"../chunks/index-dd47dd75.js";function W(e){let t=e.length,a;for(;t!=0;)a=Math.floor(Math.random()*t),t--,[e[t],e[a]]=[e[a],e[t]];return e}const m="/mario-games/",X=`${m}cards/mushroom.png`,Z=`${m}cards/flower.png`,ee=`${m}cards/coin10.png`,te=`${m}cards/coin20.png`,ae=`${m}cards/star.png`,ne=`${m}cards/chest.png`,se=`${m}cards/backface.png`,re=`${m}cards/highlight.png`,ce=`${m}sounds/correct-match.wav`,le=`${m}sounds/wrong-match.wav`;var q=(e=>(e.MUSHROOM="ncard/MUSHROOM",e.FLOWER="ncard/FLOWER",e.COIN10="ncard/COIN10",e.COIN20="ncard/COIN20",e.STAR="ncard/STAR",e.CHEST="ncard/CHEST",e))(q||{});const _=e=>{const t=`${e}`.replace("ncard/","");switch(e){case"ncard/MUSHROOM":return{img:X,type:e,name:t};case"ncard/FLOWER":return{img:Z,type:e,name:t};case"ncard/CHEST":return{img:ne,type:e,name:t};case"ncard/COIN10":return{img:ee,type:e,name:t};case"ncard/COIN20":return{img:te,type:e,name:t};case"ncard/STAR":return{img:ae,type:e,name:t};default:throw"Unknown card type"}},oe=()=>se,ie=()=>re,L={correctMatch:()=>new Audio(ce),wrongMatch:()=>new Audio(le)},de=()=>{const e=W([...Object.values(q)]),t=Math.ceil(e.length/2);return{big:e.slice(0,t),small:e.slice(-t)}},ue=()=>{const e=de(),t=[].concat(...e.big.map(s=>[_(s),_(s),_(s),_(s)])),a=[].concat(...e.small.map(s=>[_(s),_(s)]));return W([...t,...a])};function U(e,t,a){const s=e.slice();return s[13]=t[a],s[15]=a,s}function B(e){let t,a,s,o,r,c,n,l,h,v,S,C,f,M;return{c(){t=b("div"),a=b("button"),s=b("img"),r=j(),c=b("img"),C=j(),this.h()},l(g){t=w(g,"DIV",{class:!0,style:!0});var i=O(t);a=w(i,"BUTTON",{class:!0,title:!0,"aria-label":!0,"data-target-idx":!0});var d=O(a);s=w(d,"IMG",{class:!0,src:!0,alt:!0}),r=P(d),c=w(d,"IMG",{class:!0,src:!0,alt:!0}),d.forEach(I),C=P(i),i.forEach(I),this.h()},h(){u(s,"class","face back svelte-1r9g2j2"),R(s.src,o=e[1])||u(s,"src",o),u(s,"alt","Back face"),u(c,"class","face front svelte-1r9g2j2"),R(c.src,n=e[13].img)||u(c,"src",n),u(c,"alt","Front face"),u(a,"class",l="card "+(e[13].revealed?"revealed":"")+" svelte-1r9g2j2"),a.disabled=h=e[13].revealed,u(a,"title",v=e[13].name),u(a,"aria-label","Card"),u(a,"data-target-idx",S=e[15]),u(t,"class","card-wrapper svelte-1r9g2j2"),K(t,"--highlight-img","url("+e[2]+")")},m(g,i){F(g,t,i),p(t,a),p(a,s),p(a,r),p(a,c),p(t,C),f||(M=x(a,"click",e[3]),f=!0)},p(g,i){i&1&&!R(c.src,n=g[13].img)&&u(c,"src",n),i&1&&l!==(l="card "+(g[13].revealed?"revealed":"")+" svelte-1r9g2j2")&&u(a,"class",l),i&1&&h!==(h=g[13].revealed)&&(a.disabled=h),i&1&&v!==(v=g[13].name)&&u(a,"title",v)},d(g){g&&I(t),f=!1,M()}}}function ge(e){let t,a,s=e[0],o=[];for(let r=0;r<s.length;r+=1)o[r]=B(U(e,s,r));return{c(){t=b("div"),a=b("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){t=w(r,"DIV",{class:!0});var c=O(t);a=w(c,"DIV",{class:!0});var n=O(a);for(let l=0;l<o.length;l+=1)o[l].l(n);n.forEach(I),c.forEach(I),this.h()},h(){u(a,"class","cards-board svelte-1r9g2j2"),u(t,"class","memory-game svelte-1r9g2j2")},m(r,c){F(r,t,c),p(t,a);for(let n=0;n<o.length;n+=1)o[n].m(a,null)},p(r,[c]){if(c&15){s=r[0];let n;for(n=0;n<s.length;n+=1){const l=U(r,s,n);o[n]?o[n].p(l,c):(o[n]=B(l),o[n].c(),o[n].m(a,null))}for(;n<o.length;n+=1)o[n].d(1);o.length=s.length}},i:A,o:A,d(r){r&&I(t),Q(o,r)}}}function me(e,t,a){const s=oe(),o=ie(),r=ue();let c=!1,n=new Set,l=new Set,h=f();async function v(){c=!0,await document.querySelector(".memory-game").animate([{backgroundPosition:"0 center"},{backgroundPosition:" 100px center"}],{duration:150,easing:"steps(2)",direction:"normal",iterations:10}).finished,c=!1}async function S(i,d="normal"){c=!0,await i.animate([{transform:"rotateY(0.5turn)"},{transform:"rotateY(2turn)"}],{duration:1e3,easing:"ease",direction:d}).finished,c=!1}function C(){return new Set([...l].map(d=>r[d].type)).size===1}function f(){return r.map((i,d)=>N(H({},i),{revealed:n.has(d)||l.has(d)}))}async function M(i,d){if(!(l.size===2||c||n.has(d)||l.has(d))){if(console.log("Revealing..."),await S(i),l=new Set([...l,d]),a(0,h=f()),console.log("Revealed..."),l.size!==2){console.log("Ready for more");return}C()?(n=new Set([...n,...l]),await Promise.all([L.correctMatch().play(),await v()]),console.log("RIGHT!!! congrats!")):(console.log("WRONG!!!! resetting play"),await Promise.all([L.wrongMatch().play(),...[...l].map(k=>S(document.querySelector(`.card[data-target-idx="${k}"]`),"reverse"))])),l=new Set,a(0,h=f())}}function g(i){const d=i.currentTarget;M(d,Number(d.dataset.targetIdx))}return[h,s,o,g]}class ve extends T{constructor(t){super(),Y(this,t,me,ge,J,{})}}export{ve as default};
