var D=Object.defineProperty,G=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var E=(e,t,a)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,H=(e,t)=>{for(var a in t||(t={}))z.call(t,a)&&E(e,a,t[a]);if($)for(var a of $(t))V.call(t,a)&&E(e,a,t[a]);return e},N=(e,t)=>G(e,W(t));import{S as x,i as y,s as T,e as b,k as j,c as C,a as O,m as P,d as S,b as i,K as k,f as Y,g as F,J as I,L as J,n as L,M as K}from"../chunks/index-dd47dd75.js";function q(e){let t=e.length,a;for(;t!=0;)a=Math.floor(Math.random()*t),t--,[e[t],e[a]]=[e[a],e[t]];return e}const f="/mario-games/",Q=`${f}cards/mushroom.png`,X=`${f}cards/flower.png`,Z=`${f}cards/coin10.png`,ee=`${f}cards/coin20.png`,te=`${f}cards/star.png`,ae=`${f}cards/chest.png`,se=`${f}cards/backface.png`,ne=`${f}cards/highlight.png`;var A=(e=>(e.MUSHROOM="ncard/MUSHROOM",e.FLOWER="ncard/FLOWER",e.COIN10="ncard/COIN10",e.COIN20="ncard/COIN20",e.STAR="ncard/STAR",e.CHEST="ncard/CHEST",e))(A||{});const p=e=>{const t=`${e}`.replace("ncard/","");switch(e){case"ncard/MUSHROOM":return{img:Q,type:e,name:t};case"ncard/FLOWER":return{img:X,type:e,name:t};case"ncard/CHEST":return{img:ae,type:e,name:t};case"ncard/COIN10":return{img:Z,type:e,name:t};case"ncard/COIN20":return{img:ee,type:e,name:t};case"ncard/STAR":return{img:te,type:e,name:t};default:throw"Unknown card type"}},re=()=>se,ce=()=>ne,le=()=>{const e=q([...Object.values(A)]),t=Math.ceil(e.length/2);return{big:e.slice(0,t),small:e.slice(-t)}},oe=()=>{const e=le(),t=[].concat(...e.big.map(n=>[p(n),p(n),p(n),p(n)])),a=[].concat(...e.small.map(n=>[p(n),p(n)]));return q([...t,...a])};function U(e,t,a){const n=e.slice();return n[13]=t[a],n[15]=a,n}function B(e){let t,a,n,o,r,c,s,l,h,R,v,w,_;return{c(){t=b("div"),a=b("button"),n=b("img"),r=j(),c=b("img"),v=j(),this.h()},l(d){t=C(d,"DIV",{class:!0,style:!0});var m=O(t);a=C(m,"BUTTON",{class:!0,title:!0,"aria-label":!0,"data-target-idx":!0});var g=O(a);n=C(g,"IMG",{class:!0,src:!0,alt:!0}),r=P(g),c=C(g,"IMG",{class:!0,src:!0,alt:!0}),g.forEach(S),v=P(m),m.forEach(S),this.h()},h(){i(n,"class","face back svelte-1r9g2j2"),k(n.src,o=e[1])||i(n,"src",o),i(n,"alt","Back face"),i(c,"class","face front svelte-1r9g2j2"),k(c.src,s=e[13].img)||i(c,"src",s),i(c,"alt","Front face"),i(a,"class",l="card "+(e[13].revealed?"revealed":"")+" svelte-1r9g2j2"),i(a,"title",h=e[13].name),i(a,"aria-label","Card"),i(a,"data-target-idx",R=e[15]),i(t,"class","card-wrapper svelte-1r9g2j2"),Y(t,"--highlight-img","url("+e[2]+")")},m(d,m){F(d,t,m),I(t,a),I(a,n),I(a,r),I(a,c),I(t,v),w||(_=J(a,"click",e[3]),w=!0)},p(d,m){m&1&&!k(c.src,s=d[13].img)&&i(c,"src",s),m&1&&l!==(l="card "+(d[13].revealed?"revealed":"")+" svelte-1r9g2j2")&&i(a,"class",l),m&1&&h!==(h=d[13].name)&&i(a,"title",h)},d(d){d&&S(t),w=!1,_()}}}function ie(e){let t,a,n=e[0],o=[];for(let r=0;r<n.length;r+=1)o[r]=B(U(e,n,r));return{c(){t=b("div"),a=b("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){t=C(r,"DIV",{class:!0});var c=O(t);a=C(c,"DIV",{class:!0});var s=O(a);for(let l=0;l<o.length;l+=1)o[l].l(s);s.forEach(S),c.forEach(S),this.h()},h(){i(a,"class","cards-board svelte-1r9g2j2"),i(t,"class","memory-game svelte-1r9g2j2")},m(r,c){F(r,t,c),I(t,a);for(let s=0;s<o.length;s+=1)o[s].m(a,null)},p(r,[c]){if(c&15){n=r[0];let s;for(s=0;s<n.length;s+=1){const l=U(r,n,s);o[s]?o[s].p(l,c):(o[s]=B(l),o[s].c(),o[s].m(a,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},i:L,o:L,d(r){r&&S(t),K(o,r)}}}function ge(e,t,a){const n=re(),o=ce(),r=oe();let c=!1,s=new Set,l=new Set,h=_();async function R(){c=!0,await document.querySelector(".memory-game").animate([{backgroundPosition:"0 center"},{backgroundPosition:" 100px center"}],{duration:150,easing:"steps(2)",direction:"normal",iterations:10}).finished,c=!1}async function v(g,u="normal"){c=!0,await g.animate([{transform:"rotateY(0.5turn)"},{transform:"rotateY(2turn)"}],{duration:1e3,easing:"ease",direction:u}).finished,c=!1}function w(){return new Set([...l].map(u=>r[u].type)).size===1}function _(){return r.map((g,u)=>N(H({},g),{revealed:s.has(u)||l.has(u)}))}async function d(g,u){if(!(l.size===2||c||s.has(u)||l.has(u))){if(console.log("Revealing..."),await v(g),l=new Set([...l,u]),a(0,h=_()),console.log("Revealed..."),l.size!==2){console.log("Ready for more");return}w()?(s=new Set([...s,...l]),await R(),console.log("RIGHT!!! congrats!")):(console.log("WRONG!!!! resetting play"),await Promise.all([...l].map(M=>v(document.querySelector(`.card[data-target-idx="${M}"]`),"reverse")))),l=new Set,a(0,h=_())}}function m(g){const u=g.currentTarget;d(u,Number(u.dataset.targetIdx))}return[h,n,o,m]}class me extends x{constructor(t){super(),y(this,t,ge,ie,T,{})}}export{me as default};
